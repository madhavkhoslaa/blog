<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Functional Programming in Rust 2: Iterators - Madhav Khosla</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Creational design patterns aid in the instantiation of objects by providing suitable abstractions and make the systems independent of how objects are created composed and represented."><meta property="og:image" content><meta property="og:title" content="Functional Programming in Rust 2: Iterators"><meta property="og:description" content="Creational design patterns aid in the instantiation of objects by providing suitable abstractions and make the systems independent of how objects are created composed and represented."><meta property="og:type" content="article"><meta property="og:url" content="https://madhavkhoslaa.github.io/posts/rustiter/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-20T23:01:35+05:30"><meta property="article:modified_time" content="2022-11-20T23:01:35+05:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="Functional Programming in Rust 2: Iterators"><meta name=twitter:description content="Creational design patterns aid in the instantiation of objects by providing suitable abstractions and make the systems independent of how objects are created composed and represented."><script src=https://madhavkhoslaa.github.io/js/feather.min.js></script>
<link href=https://madhavkhoslaa.github.io/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://madhavkhoslaa.github.io/css/main.40ca3a860425083862b7ebd55447caec5c4384573f0cb098b8d06a91e8dace2e.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://madhavkhoslaa.github.io/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css></head><body><div class=content><header><div class=main><a href=https://madhavkhoslaa.github.io/>Madhav Khosla</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/about>About</a>
<a href=/draft>Draft</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>Functional Programming in Rust 2: Iterators</h1><div class=meta>Posted on Nov 20, 2022</div></div><section class=body><h1 id=iterator-design-pattern-what-is-it>Iterator Design Pattern, What is it?</h1><h2 id=example-1>Example 1</h2><p>Let&rsquo;s consider you are this tiny person in the image and you have to walk traverse the tree below. Ideally, how you traverse it, it does not matter what is the most important thing is <strong>1.</strong> where you are and <strong>2.</strong> Where you want to be when you go to the <code>next</code> node.</p><p>So in a way, an iterator design pattern(in real life) is a thought process of how you iterate a structure(not just a tree), or you know where you want(not how) to go <code>next</code>.</p><p>It is the way to decide if you go on the left node or the right, or the leaf node of the left subtree or the leaf node of the rightmost subtree but not how you do it.</p><p><img src=https://i.imgur.com/mWXRCUt.png alt=image></p><h2 id=example-2>Example 2</h2><p>Imagine you are the Pacman ghost and the representation of the Pacman world is in a graph. Which node you go to is dependent on where Pacman is. Imagine you are on a <code>T</code> intersection and Pacman is on the right side of the T intersection. Then the <code>next</code> node you want to traverse is the right node.</p><p><img src=https://i.imgur.com/5lF87Jv.png alt=image></p><h2 id=why-did-i-highlight-next---lets-talk-code>Why did I highlight <code>next</code> ? | Let&rsquo;s talk Code.</h2><h1 id=iter-trait>Iter trait</h1><p>This</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>trait</span> Iterator {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Item</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>next</span>(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> self) -&gt; Option<span style=color:#f92672>&lt;</span>Self::Item<span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>I will talk about the iter trait below in the blog once I get done with explaining how to use pre-built iterators.</p><h1 id=iterators-in-rust>Iterators in Rust</h1><p>Lazy Iterator example</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>let</span> v: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> vec![<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> vec_iter <span style=color:#f92672>=</span> v.iter();
</span></span></code></pre></div><h2 id=iterating-a-list-using-iterators>Iterating a List using iterators</h2><p>Using lazy iterator to iterate</p><h3 id=example-1-immutable-iterator>Example 1 (Immutable iterator)</h3><p>The value of next sends a reference to the value in the data structure. In our case, we create an instance of the iterator called <code>vec_iter</code>. Then use it to loop through our list. The iterator&rsquo;s next trait is implemented in the <code>for in</code> loop in rust.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> v: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> vec![<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> vec_iter <span style=color:#f92672>=</span> v.iter();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> vec_val <span style=color:#66d9ef>in</span> vec_iter{
</span></span><span style=display:flex><span>        println!(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span>, vec_val);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Output</p><pre tabindex=0><code>1
2
3
4
</code></pre><h3 id=example-1-mutable-iterator>Example 1 (Mutable iterator)</h3><p>For example, if you want to increment the value of the item in the data structure through the loop you need a mutable reference to the value in the data struct. Creating an iterator with <code>iter_mut</code> returns mutable references to the value in the loop.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> v: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> vec![<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>];
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{:?}</span><span style=color:#e6db74>&#34;</span>, v);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> vec_iter <span style=color:#f92672>=</span> v.iter_mut();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> vec_val <span style=color:#66d9ef>in</span> vec_iter{
</span></span><span style=display:flex><span>        <span style=color:#f92672>*</span>vec_val <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>vec_val <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{:?}</span><span style=color:#e6db74>&#34;</span>, v);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Output</p><pre tabindex=0><code>[1, 2, 3, 4]
[2, 3, 4, 5]
</code></pre><h1 id=producers-of-iterators>Producers of iterators</h1><p>These are methods that attach to iterators to produce more iterators. Popular examples of these &ldquo;Producers&rdquo; are 1. <code>Map</code> 2. <code>Filter</code>. Also, I assume if you&rsquo;re reading this blog you are aware of the concepts of map and filter.</p><p>A map creates an iterator that you can attach other iterators (and so on&mldr;).
An obvious question to this is how do you resolve these chained iterators to get a value? This leads us to the next topic</p><h1 id=consumers-of-iterators>Consumers of iterators</h1><p>Consumers are methods like <code>collect</code> the take in chained iterators and run it one by one on data that each producer resolves to.</p><p><code>Iterator1 => Data => Iterator 2 => Data => Iterator 3 => Data</code></p><p>^This what a consumer does.</p><h1 id=example-of-how-to-use-producers-and-consumers-of-iterators>Example of how to use producers and consumers of iterators</h1><p>Let&rsquo;s try to create the above example of iterating to increase the value of elements in an array using <code>Map</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> x: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> vec![<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> y: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> x.iter().map(<span style=color:#f92672>|</span>x<span style=color:#f92672>|</span> x <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>).collect();
</span></span><span style=display:flex><span>    <span style=color:#75715e>//                        ^---Producer  ^----------------Consumer 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    println!(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{:?}</span><span style=color:#e6db74>&#34;</span>, y);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Output</p><pre tabindex=0><code>[2, 3, 4, 5]
</code></pre><h2 id=using-multiple-producers>Using multiple producers</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> vec: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> vec![<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>10</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> vec2: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> vec.iter().map(<span style=color:#f92672>|</span>x<span style=color:#f92672>|</span> x <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>).map(<span style=color:#f92672>|</span>x<span style=color:#f92672>|</span> x <span style=color:#f92672>+</span> <span style=color:#ae81ff>10</span>).filter(<span style=color:#f92672>|</span>x<span style=color:#f92672>|</span> x<span style=color:#f92672>%</span><span style=color:#ae81ff>2</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>).collect();
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Divides all numbers by 2 into a u8 then adds 10 to everything. Then filters out even numbers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    println!(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{:?}</span><span style=color:#e6db74>&#34;</span>, vec2);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=the-three-forms-of-iteration>The three forms of iteration</h1><ol><li>iter(), which iterates over &amp;T.</li><li>iter_mut(), which iterates over &amp;mut T.</li><li>into_iter(), which iterates over T.</li></ol><h1 id=revisiting-the-iter-trait>Revisiting the Iter trait</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>trait</span> Iterator {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Item</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>next</span>(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> self) -&gt; Option<span style=color:#f92672>&lt;</span>Self::Item<span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>calling next will return an <code>Option&lt;Self::item></code> as long as there are elements in the collection.</p><h1 id=example-of-implementing-iter-trait-to-create-own-iterator-for-our-data-structure>Example of implementing Iter trait to create own iterator for our data structure.</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Counter</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> limit: <span style=color:#66d9ef>usize</span>,
</span></span><span style=display:flex><span>    count: <span style=color:#66d9ef>usize</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>impl</span> Counter {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>new</span>(limit: <span style=color:#66d9ef>usize</span>) -&gt; <span style=color:#a6e22e>Counter</span> {
</span></span><span style=display:flex><span>        Counter {
</span></span><span style=display:flex><span>            limit,
</span></span><span style=display:flex><span>            count: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>impl</span> Iterator <span style=color:#66d9ef>for</span> Counter {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Item</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>usize</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>next</span>(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> self) -&gt; Option<span style=color:#f92672>&lt;</span>Self::Item<span style=color:#f92672>&gt;</span>{
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self.count <span style=color:#f92672>&lt;=</span> self.limit {
</span></span><span style=display:flex><span>            self.count <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> Some(self.count);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        None
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> c <span style=color:#f92672>=</span> Counter::new(<span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> start <span style=color:#f92672>=</span> Some(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>loop</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> start <span style=color:#f92672>==</span> None {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        println!(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span>, start.unwrap());
</span></span><span style=display:flex><span>        start <span style=color:#f92672>=</span> c.next();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Output</p><pre tabindex=0><code>0
1
2
3
4
5
6
7
8
9
10
11
</code></pre><h1 id=how-to-create-an-iterator-to-traverse-a-tree-using-for-loops--fun-code-ahead>How to create an iterator to traverse a tree using for loops !!!! [FUN CODE AHEAD!]</h1><p><img src=https://i.imgur.com/Unw3Dwf.jpeg alt=image></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>// More than two derives
</span></span></span><span style=display:flex><span><span style=color:#75715e>// generics
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Deref coercion
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#[derive(Debug, Clone)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Node</span> {
</span></span><span style=display:flex><span>    left: Option<span style=color:#f92672>&lt;</span>Box<span style=color:#f92672>&lt;</span>Node<span style=color:#f92672>&gt;&gt;</span>,
</span></span><span style=display:flex><span>    right: Option<span style=color:#f92672>&lt;</span>Box<span style=color:#f92672>&lt;</span>Node<span style=color:#f92672>&gt;&gt;</span>,
</span></span><span style=display:flex><span>    value: <span style=color:#66d9ef>u8</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>PreTreeIterator</span> {
</span></span><span style=display:flex><span>    head: <span style=color:#a6e22e>Node</span>,
</span></span><span style=display:flex><span>    iter_list: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>    current_value: Option<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>u8</span><span style=color:#f92672>&gt;</span>,
</span></span><span style=display:flex><span>    ctr: <span style=color:#66d9ef>usize</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>impl</span> PreTreeIterator {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>new</span>(head: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>Node</span>) -&gt; <span style=color:#a6e22e>PreTreeIterator</span> {
</span></span><span style=display:flex><span>        PreTreeIterator {
</span></span><span style=display:flex><span>            head: <span style=color:#a6e22e>head</span>.clone(),
</span></span><span style=display:flex><span>            iter_list: <span style=color:#a6e22e>vec</span><span style=color:#f92672>!</span>[],
</span></span><span style=display:flex><span>            current_value: None,
</span></span><span style=display:flex><span>            ctr: <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>generate_iter_list</span>(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> self, head: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>Node</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>match</span> <span style=color:#f92672>&amp;</span>head.left {
</span></span><span style=display:flex><span>            Some(x) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                self.generate_iter_list(x);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            None <span style=color:#f92672>=&gt;</span> {}
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        self.iter_list.push(head.value);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>match</span> <span style=color:#f92672>&amp;</span>head.right {
</span></span><span style=display:flex><span>            Some(x) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                self.generate_iter_list(x);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            None <span style=color:#f92672>=&gt;</span> {}
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>impl</span> Iterator <span style=color:#66d9ef>for</span> PreTreeIterator {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Item</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>u8</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>next</span>(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> self) -&gt; Option<span style=color:#f92672>&lt;</span>Self::Item<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self.ctr <span style=color:#f92672>&lt;</span> self.iter_list.len() {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> to_return <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>self.iter_list.get(self.ctr).unwrap();
</span></span><span style=display:flex><span>            self.ctr <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> Some(to_return);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            None
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> tree <span style=color:#f92672>=</span> Node {
</span></span><span style=display:flex><span>        left: Some(Box::new(Node {
</span></span><span style=display:flex><span>            left: None,
</span></span><span style=display:flex><span>            right: Some(Box::new(Node {
</span></span><span style=display:flex><span>                left: None,
</span></span><span style=display:flex><span>                right: None,
</span></span><span style=display:flex><span>                value: <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>            })),
</span></span><span style=display:flex><span>            value: <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>        })),
</span></span><span style=display:flex><span>        right: Some(Box::new(Node {
</span></span><span style=display:flex><span>            left: None,
</span></span><span style=display:flex><span>            right: None,
</span></span><span style=display:flex><span>            value: <span style=color:#ae81ff>9</span>,
</span></span><span style=display:flex><span>        })),
</span></span><span style=display:flex><span>        value: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{:?}</span><span style=color:#e6db74>&#34;</span>, tree);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> iter <span style=color:#f92672>=</span> PreTreeIterator::new(<span style=color:#f92672>&amp;</span>tree);
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{:?}</span><span style=color:#e6db74>&#34;</span>, iter.iter_list);
</span></span><span style=display:flex><span>    iter.generate_iter_list(<span style=color:#f92672>&amp;</span>tree);
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{:?}</span><span style=color:#e6db74>&#34;</span>, iter.iter_list);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;Looping through the tree in preiterator way using iterator design pattern&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>loop</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> value <span style=color:#f92672>=</span> iter.next();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> value <span style=color:#f92672>==</span> None {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        println!(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{:?}</span><span style=color:#e6db74>&#34;</span>, value.unwrap());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Node { left: Some(Node { left: None, right: Some(Node { left: None, right: None, value: 3 }), value: 2 }), right: Some(Node { left: None, right: None, value: 9 }), value: 1 }
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h2 id=output>Output</h2><pre tabindex=0><code>[]
[2, 3, 1, 9]
Looping through the tree in pre-order way using the iterator design pattern
2
3
1
9
</code></pre><hr><p>Sources</p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/design-patterns>Design Patterns</a></li><li><a href=/tags/iterator-design-pattern>Iterator Design Pattern</a></li><li><a href=/tags/rust>Rust</a></li><li><a href=/tags/blazingly-fast>Blazingly Fast</a></li><li><a href=/tags/loops>loops</a></li><li><a href=/tags/not-c++>Not C++</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=https://bit.ly/3Qyr87Y title=GitHub><i data-feather=github></i></a><a class=soc href=https://bit.ly/3Qtgn6y title=Twitter><i data-feather=twitter></i></a></div><div class=footer-info>2023 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script>feather.replace()</script></div></body></html>